<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ôn thi Vật Lý 10 - Định luật Newton</title>
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- MathJax Configuration -->
    <script>
    window.MathJax = {
      tex: {
        inlineMath: [['$', '$'], ['\\(', '\\)']],
        displayMath: [['$$', '$$'], ['\\[', '\\]']],
        processEscapes: true,
        packages: {'[+]': ['noerrors', 'noundefined']}
      },
      options: {
        ignoreHtmlClass: 'tex2jax_ignore',
        processHtmlClass: 'tex2jax_process'
      },
      chtml: {
        scale: 1.1,
        minScale: 1
      },
      loader: {
        load: ['[tex]/noerrors', '[tex]/noundefined']
      }
    };
    </script>
    <script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>

    <!-- FontAwesome for Icons -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap');
        
        body { font-family: 'Inter', sans-serif; -webkit-font-smoothing: antialiased; }
        
        /* Custom Scrollbar */
        ::-webkit-scrollbar { width: 8px; }
        ::-webkit-scrollbar-track { background: #f1f5f9; }
        ::-webkit-scrollbar-thumb { background: #94a3b8; border-radius: 4px; }
        ::-webkit-scrollbar-thumb:hover { background: #64748b; }

        .tab-content { display: none; animation: fadeIn 0.4s ease-out; }
        .tab-content.active { display: block; }
        
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        /* Quiz Styles Refined */
        .quiz-card { transition: all 0.3s ease; }
        .quiz-option {
            transition: all 0.2s;
            position: relative;
            overflow: hidden;
        }
        .quiz-option:hover:not(:disabled) {
            transform: translateY(-2px);
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06);
        }
        .quiz-option.selected { border-color: #3b82f6; background-color: #eff6ff; }
        .quiz-option.correct { border-color: #10b981; background-color: #ecfdf5; color: #065f46; }
        .quiz-option.wrong { border-color: #ef4444; background-color: #fef2f2; color: #991b1b; }
        
        /* MathJax Adjustments */
        mjx-container { 
            font-size: 115% !important; 
            outline: none !important;
        }
        .math-inline { display: inline-block; vertical-align: middle; }

        /* Floating Badge */
        .creator-badge {
            position: fixed;
            bottom: 20px;
            right: 20px;
            background: rgba(30, 41, 59, 0.9);
            color: white;
            padding: 8px 16px;
            border-radius: 999px;
            font-size: 12px;
            font-weight: 600;
            box-shadow: 0 4px 12px rgba(0,0,0,0.15);
            z-index: 100;
            backdrop-filter: blur(4px);
            transition: all 0.3s ease;
            border: 1px solid rgba(255,255,255,0.1);
        }
        .creator-badge:hover {
            transform: translateY(-2px);
            background: rgba(37, 99, 235, 0.9);
        }

        /* Print styles */
        @media print {
            .no-print { display: none; }
            body { background: white; color: black; }
        }
    </style>
</head>
<body class="bg-slate-100 text-slate-800 flex flex-col min-h-screen">

    <!-- Navbar -->
    <nav class="sticky top-0 z-50 bg-white/95 backdrop-blur-sm shadow-sm border-b border-slate-200">
        <div class="container mx-auto px-4">
            <div class="flex justify-between items-center h-16">
                <!-- Logo -->
                <div class="flex items-center gap-3 cursor-pointer group" onclick="showTab('home')">
                    <div class="w-10 h-10 bg-gradient-to-br from-blue-600 to-blue-700 rounded-xl flex items-center justify-center text-white font-bold text-xl shadow-lg shadow-blue-200 group-hover:scale-105 transition">
                        <i class="fa-solid fa-atom"></i>
                    </div>
                    <div class="hidden md:block">
                        <span class="block text-lg font-bold text-slate-800 leading-tight">Vật Lý 10</span>
                        <span class="block text-xs text-slate-500 font-medium">Động Lực Học</span>
                    </div>
                </div>

                <!-- Menu Desktop -->
                <div class="hidden md:flex items-center space-x-1">
                    <button onclick="showTab('theory')" class="nav-item px-4 py-2 rounded-lg text-slate-600 hover:bg-slate-50 hover:text-blue-600 font-medium transition" data-target="theory">
                        Lý Thuyết
                    </button>
                    <button onclick="showTab('quiz')" class="nav-item px-4 py-2 rounded-lg text-slate-600 hover:bg-slate-50 hover:text-blue-600 font-medium transition" data-target="quiz">
                        Trắc Nghiệm
                    </button>
                    <button onclick="showTab('practice')" class="nav-item px-4 py-2 rounded-lg text-slate-600 hover:bg-slate-50 hover:text-blue-600 font-medium transition" data-target="practice">
                        Tự Luận
                    </button>
                    <div class="w-px h-6 bg-slate-300 mx-2"></div>
                    <button onclick="toggleSummaryModal()" class="px-4 py-2 bg-yellow-50 text-yellow-700 border border-yellow-200 rounded-lg hover:bg-yellow-100 font-medium transition flex items-center shadow-sm">
                        <i class="fa-solid fa-bolt mr-2"></i>Cấp Tốc
                    </button>
                </div>

                <!-- Mobile Menu Button -->
                <button onclick="toggleMobileMenu()" class="md:hidden p-2 text-slate-600 hover:text-blue-600 transition">
                    <i class="fa-solid fa-bars text-2xl"></i>
                </button>
            </div>
        </div>
        
        <!-- Mobile Menu Dropdown -->
        <div id="mobile-menu" class="hidden md:hidden bg-white border-t border-slate-100 p-4 space-y-2 shadow-xl absolute w-full z-50">
            <button onclick="showTab('theory'); toggleMobileMenu()" class="w-full text-left px-4 py-3 rounded-lg hover:bg-slate-50 font-medium"><i class="fa-solid fa-book-open mr-3 text-blue-500"></i>Lý Thuyết</button>
            <button onclick="showTab('quiz'); toggleMobileMenu()" class="w-full text-left px-4 py-3 rounded-lg hover:bg-slate-50 font-medium"><i class="fa-solid fa-circle-question mr-3 text-green-500"></i>Trắc Nghiệm</button>
            <button onclick="showTab('practice'); toggleMobileMenu()" class="w-full text-left px-4 py-3 rounded-lg hover:bg-slate-50 font-medium"><i class="fa-solid fa-pen-ruler mr-3 text-purple-500"></i>Tự Luận</button>
            <button onclick="toggleSummaryModal(); toggleMobileMenu()" class="w-full text-left px-4 py-3 rounded-lg hover:bg-slate-50 font-medium"><i class="fa-solid fa-bolt mr-3 text-yellow-500"></i>Tóm tắt nhanh</button>
        </div>
    </nav>

    <!-- Floating Badge -->
    <a href="https://www.facebook.com/vdnguyen1996" target="_blank" class="creator-badge no-print">
        <i class="fa-solid fa-code mr-2"></i>Created By VD
    </a>

    <!-- Main Content -->
    <main class="flex-grow container mx-auto px-4 py-8">

        <!-- TAB: HOME (Dashboard) -->
        <section id="home" class="tab-content active">
            <div class="max-w-5xl mx-auto">
                <div class="text-center py-12 lg:py-20">
                    <span class="inline-block py-1 px-3 rounded-full bg-blue-100 text-blue-700 text-sm font-semibold mb-4">Học tập hiệu quả hơn</span>
                    <h1 class="text-4xl md:text-6xl font-extrabold text-slate-900 mb-6 tracking-tight">Chinh phục <span class="text-transparent bg-clip-text bg-gradient-to-r from-blue-600 to-purple-600">Động Lực Học</span></h1>
                    <p class="text-lg md:text-xl text-slate-600 mb-10 max-w-2xl mx-auto leading-relaxed">Nắm vững 3 Định luật Newton với hệ thống lý thuyết chuẩn SGK, ngân hàng trắc nghiệm thông minh và bài tập tự luận chi tiết.</p>
                    
                    <div class="grid grid-cols-1 md:grid-cols-3 gap-6 text-left">
                        <div onclick="showTab('theory')" class="group p-8 bg-white rounded-2xl shadow-sm border border-slate-200 hover:shadow-xl hover:border-blue-300 transition-all cursor-pointer relative overflow-hidden">
                            <div class="absolute top-0 right-0 w-32 h-32 bg-blue-50 rounded-bl-full -mr-10 -mt-10 transition group-hover:bg-blue-100"></div>
                            <div class="w-14 h-14 bg-blue-600 text-white rounded-2xl flex items-center justify-center mb-6 shadow-lg shadow-blue-200 group-hover:scale-110 transition relative z-10">
                                <i class="fa-solid fa-book text-2xl"></i>
                            </div>
                            <h3 class="text-xl font-bold mb-2 text-slate-800">Lý Thuyết</h3>
                            <p class="text-slate-500 text-sm leading-relaxed">Hệ thống hóa kiến thức trọng tâm, sơ đồ tư duy và công thức.</p>
                        </div>

                        <div onclick="showTab('quiz')" class="group p-8 bg-white rounded-2xl shadow-sm border border-slate-200 hover:shadow-xl hover:border-green-300 transition-all cursor-pointer relative overflow-hidden">
                            <div class="absolute top-0 right-0 w-32 h-32 bg-green-50 rounded-bl-full -mr-10 -mt-10 transition group-hover:bg-green-100"></div>
                            <div class="w-14 h-14 bg-green-600 text-white rounded-2xl flex items-center justify-center mb-6 shadow-lg shadow-green-200 group-hover:scale-110 transition relative z-10">
                                <i class="fa-solid fa-check-to-slot text-2xl"></i>
                            </div>
                            <h3 class="text-xl font-bold mb-2 text-slate-800">Trắc Nghiệm</h3>
                            <p class="text-slate-500 text-sm leading-relaxed">Luyện tập với bộ câu hỏi đa dạng, chấm điểm và giải thích chi tiết.</p>
                        </div>

                        <div onclick="showTab('practice')" class="group p-8 bg-white rounded-2xl shadow-sm border border-slate-200 hover:shadow-xl hover:border-purple-300 transition-all cursor-pointer relative overflow-hidden">
                            <div class="absolute top-0 right-0 w-32 h-32 bg-purple-50 rounded-bl-full -mr-10 -mt-10 transition group-hover:bg-purple-100"></div>
                            <div class="w-14 h-14 bg-purple-600 text-white rounded-2xl flex items-center justify-center mb-6 shadow-lg shadow-purple-200 group-hover:scale-110 transition relative z-10">
                                <i class="fa-solid fa-pencil text-2xl"></i>
                            </div>
                            <h3 class="text-xl font-bold mb-2 text-slate-800">Tự Luận</h3>
                            <p class="text-slate-500 text-sm leading-relaxed">Phân dạng bài tập tự luận với hướng dẫn giải từng bước.</p>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- TAB: THEORY -->
        <section id="theory" class="tab-content">
             <!-- (Nội dung lý thuyết giữ nguyên như cũ để tiết kiệm không gian file, không thay đổi logic) -->
            <div class="flex flex-col lg:flex-row gap-8 max-w-6xl mx-auto">
                <div class="lg:w-1/4">
                    <div class="bg-white p-5 rounded-2xl shadow-sm sticky top-24 border border-slate-200">
                        <h3 class="font-bold text-lg mb-4 text-slate-800 pb-2 border-b border-slate-100">Mục lục</h3>
                        <nav class="space-y-1">
                            <a href="#dl1" class="flex items-center p-3 rounded-lg hover:bg-blue-50 text-slate-600 hover:text-blue-700 transition font-medium group"><span class="w-6 h-6 rounded bg-slate-100 text-slate-500 text-xs flex items-center justify-center mr-3 group-hover:bg-blue-200 group-hover:text-blue-700">1</span> Định luật I Newton</a>
                            <a href="#dl2" class="flex items-center p-3 rounded-lg hover:bg-blue-50 text-slate-600 hover:text-blue-700 transition font-medium group"><span class="w-6 h-6 rounded bg-slate-100 text-slate-500 text-xs flex items-center justify-center mr-3 group-hover:bg-blue-200 group-hover:text-blue-700">2</span> Định luật II Newton</a>
                            <a href="#dl3" class="flex items-center p-3 rounded-lg hover:bg-blue-50 text-slate-600 hover:text-blue-700 transition font-medium group"><span class="w-6 h-6 rounded bg-slate-100 text-slate-500 text-xs flex items-center justify-center mr-3 group-hover:bg-blue-200 group-hover:text-blue-700">3</span> Định luật III Newton</a>
                            <a href="#congthuc" class="flex items-center p-3 rounded-lg hover:bg-blue-50 text-slate-600 hover:text-blue-700 transition font-medium group"><span class="w-6 h-6 rounded bg-slate-100 text-slate-500 text-xs flex items-center justify-center mr-3 group-hover:bg-blue-200 group-hover:text-blue-700">4</span> Công thức cần nhớ</a>
                        </nav>
                    </div>
                </div>
                <div class="lg:w-3/4 space-y-8">
                    <!-- DL1 -->
                    <div id="dl1" class="bg-white p-8 rounded-2xl shadow-sm border border-slate-200 scroll-mt-28 relative overflow-hidden">
                        <div class="absolute top-0 left-0 w-1 h-full bg-blue-500"></div>
                        <h2 class="text-2xl font-bold text-slate-800 mb-6 flex items-center"><span class="bg-blue-100 text-blue-700 w-10 h-10 rounded-xl flex items-center justify-center text-lg mr-4 shadow-sm">I</span>Định luật I Newton (Quán tính)</h2>
                        <div class="bg-blue-50/50 p-6 rounded-xl mb-6 text-slate-700 border border-blue-100"><p class="italic text-lg leading-relaxed font-medium text-slate-800">"Nếu một vật không chịu tác dụng của lực nào hoặc chịu tác dụng của các lực có hợp lực bằng 0, thì vật đang đứng yên sẽ tiếp tục đứng yên, đang chuyển động sẽ tiếp tục chuyển động thẳng đều."</p></div>
                        <ul class="space-y-3 text-slate-600">
                             <li class="flex items-start"><i class="fa-solid fa-check text-blue-500 mt-1 mr-2 text-xs"></i><span>Ý nghĩa: Lực không phải là nguyên nhân duy trì chuyển động.</span></li>
                             <li class="flex items-start"><i class="fa-solid fa-check text-blue-500 mt-1 mr-2 text-xs"></i><span>Quán tính: Xu hướng bảo toàn vận tốc.</span></li>
                        </ul>
                    </div>
                    <!-- DL2 -->
                    <div id="dl2" class="bg-white p-8 rounded-2xl shadow-sm border border-slate-200 scroll-mt-28 relative overflow-hidden">
                        <div class="absolute top-0 left-0 w-1 h-full bg-green-500"></div>
                        <h2 class="text-2xl font-bold text-slate-800 mb-6 flex items-center"><span class="bg-green-100 text-green-700 w-10 h-10 rounded-xl flex items-center justify-center text-lg mr-4 shadow-sm">II</span>Định luật II Newton (Gia tốc)</h2>
                        <div class="bg-green-50/50 p-6 rounded-xl mb-6 text-slate-700 border border-green-100"><p class="italic text-lg leading-relaxed font-medium text-slate-800">"Gia tốc của một vật cùng hướng với lực tác dụng lên vật. Độ lớn của gia tốc tỉ lệ thuận với độ lớn của lực và tỉ lệ nghịch với khối lượng của vật."</p></div>
                        <div class="text-center py-4"><p class="text-3xl font-bold text-slate-800 math-inline">$$\vec{a} = \frac{\vec{F}}{m}$$</p></div>
                    </div>
                    <!-- DL3 -->
                    <div id="dl3" class="bg-white p-8 rounded-2xl shadow-sm border border-slate-200 scroll-mt-28 relative overflow-hidden">
                        <div class="absolute top-0 left-0 w-1 h-full bg-red-500"></div>
                        <h2 class="text-2xl font-bold text-slate-800 mb-6 flex items-center"><span class="bg-red-100 text-red-700 w-10 h-10 rounded-xl flex items-center justify-center text-lg mr-4 shadow-sm">III</span>Định luật III Newton (Tương tác)</h2>
                        <div class="bg-red-50/50 p-6 rounded-xl mb-6 text-slate-700 border border-red-100"><p class="italic text-lg leading-relaxed font-medium text-slate-800">"Trong mọi trường hợp, khi vật A tác dụng lên vật B một lực, thì đồng thời vật B cũng tác dụng trở lại vật A một lực. Hai lực này là hai lực trực đối."</p></div>
                        <div class="text-center py-4"><p class="text-2xl font-bold text-slate-800 math-inline">$$\vec{F}_{AB} = -\vec{F}_{BA}$$</p></div>
                    </div>
                     <!-- Formulas -->
                     <div id="congthuc" class="bg-white p-8 rounded-2xl shadow-sm border border-slate-200 scroll-mt-28">
                        <h2 class="text-xl font-bold text-slate-800 mb-6 pb-4 border-b border-slate-100">4. Các Công Thức Động Học Cơ Bản</h2>
                        <div class="text-slate-700 text-sm space-y-2">
                             <p class="p-2 border-b">Vận tốc: $$v = v_0 + at$$</p>
                             <p class="p-2 border-b">Quãng đường: $$s = v_0t + \frac{1}{2}at^2$$</p>
                             <p class="p-2 border-b">Độc lập thời gian: $$v^2 - v_0^2 = 2as$$</p>
                             <p class="p-2">Động lực học: $$F = ma$$</p>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- TAB: QUIZ -->
        <section id="quiz" class="tab-content">
            <div class="max-w-4xl mx-auto">
                <div class="bg-white p-6 rounded-2xl shadow-sm border border-slate-200 mb-8 flex flex-col md:flex-row justify-between items-center gap-6">
                    <div>
                        <h2 class="text-2xl font-bold text-slate-800">Kiểm tra Trắc Nghiệm</h2>
                        <p class="text-slate-500 mt-1">Hệ thống câu hỏi ngẫu nhiên không lặp lại.</p>
                    </div>
                    <button onclick="startQuiz()" class="bg-blue-600 hover:bg-blue-700 text-white px-6 py-3 rounded-xl font-semibold transition shadow-lg shadow-blue-200 flex items-center">
                        <i class="fa-solid fa-rotate-right mr-2"></i>Làm đề mới
                    </button>
                </div>
                <div id="quiz-status" class="hidden mb-8 sticky top-20 z-40 bg-white/90 backdrop-blur-md p-4 rounded-xl shadow-md border border-slate-200 transition-all">
                    <div class="flex justify-between items-end mb-3">
                        <div class="flex items-baseline gap-2">
                            <span class="text-sm font-semibold text-slate-500 uppercase">Câu hỏi</span>
                            <span class="text-2xl font-bold text-slate-800"><span id="current-q-num">1</span><span class="text-slate-400 text-lg">/</span><span id="total-q-num" class="text-slate-400 text-lg">10</span></span>
                        </div>
                        <div class="flex items-baseline gap-2">
                            <span class="text-sm font-semibold text-slate-500 uppercase">Điểm số</span>
                            <span class="text-2xl font-bold text-blue-600" id="current-score">0</span>
                        </div>
                    </div>
                    <div class="w-full bg-slate-100 rounded-full h-2.5 overflow-hidden">
                        <div id="quiz-progress-bar" class="bg-gradient-to-r from-blue-500 to-indigo-500 h-full rounded-full transition-all duration-500" style="width: 0%"></div>
                    </div>
                </div>
                <div id="quiz-container" class="space-y-8 pb-20">
                    <div class="text-center py-24 bg-white rounded-2xl shadow-sm border border-slate-200 dashed-border">
                        <div class="w-20 h-20 bg-slate-50 rounded-full flex items-center justify-center mx-auto mb-6 text-slate-300"><i class="fa-solid fa-clipboard-list text-4xl"></i></div>
                        <h3 class="text-xl font-bold text-slate-700 mb-2">Sẵn sàng thử thách?</h3>
                        <p class="text-slate-500 max-w-md mx-auto">Nhấn nút "Làm đề mới" để bắt đầu.</p>
                    </div>
                </div>
            </div>
        </section>

        <!-- TAB: PRACTICE -->
        <section id="practice" class="tab-content">
            <div class="max-w-4xl mx-auto">
                <div class="text-center mb-10">
                    <h2 class="text-3xl font-bold text-slate-800 mb-3">Bài Tập Tự Luận</h2>
                    <p class="text-slate-500">Tuyển tập các dạng bài tập có lời giải chi tiết và hình minh họa riêng biệt.</p>
                </div>
                <div class="space-y-6" id="practice-container"></div>
            </div>
        </section>

    </main>

    <!-- Footer -->
    <footer class="bg-slate-900 text-slate-400 py-12 mt-auto no-print">
        <div class="container mx-auto px-4 text-center">
            <p class="mb-2 font-medium">Hệ thống Ôn tập Vật lý 10</p>
            <p class="text-sm text-slate-600 mb-4">Created By VD</p>
        </div>
    </footer>

    <!-- Cheat Sheet Modal -->
    <div id="summary-modal" class="fixed inset-0 bg-slate-900/60 z-[100] hidden flex items-center justify-center p-4 backdrop-blur-sm transition-opacity opacity-0">
        <div class="bg-white rounded-2xl shadow-2xl w-full max-w-3xl max-h-[85vh] overflow-hidden flex flex-col" id="summary-content">
             <div class="bg-white p-5 border-b border-slate-100 flex justify-between items-center sticky top-0 z-10">
                <h3 class="text-xl font-bold text-slate-800"><i class="fa-solid fa-bolt text-yellow-500 mr-3"></i>Tóm tắt kiến thức</h3>
                <button onclick="toggleSummaryModal()" class="w-8 h-8 rounded-full bg-slate-100 text-slate-500 hover:text-red-500 flex items-center justify-center"><i class="fa-solid fa-xmark"></i></button>
            </div>
            <div class="p-6 overflow-y-auto custom-scrollbar bg-slate-50/50">
                <!-- Nội dung tóm tắt giữ nguyên -->
                <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                    <div class="bg-white p-4 rounded-lg shadow-sm border border-blue-100"><h4 class="font-bold text-blue-700">ĐL I (Quán tính)</h4><p class="text-sm mt-2">$\sum F = 0 \Rightarrow a = 0$.</p></div>
                    <div class="bg-white p-4 rounded-lg shadow-sm border border-green-100"><h4 class="font-bold text-green-700">ĐL II (Gia tốc)</h4><p class="text-sm mt-2">$F = ma$.</p></div>
                    <div class="bg-white p-4 rounded-lg shadow-sm border border-red-100"><h4 class="font-bold text-red-700">ĐL III (Tương tác)</h4><p class="text-sm mt-2">$F_{12} = -F_{21}$.</p></div>
                </div>
            </div>
        </div>
    </div>

    <!-- JAVASCRIPT -->
    <script>
        // --- DATA: QUIZ BANK (Expanded) ---
        const quizBank = [
            // ĐL 1
            { id: 1, type: 'theory', q: "Định luật I Newton còn được gọi là:", a: ["Định luật bảo toàn năng lượng", "Định luật Quán tính", "Định luật Vạn vật hấp dẫn", "Định luật Tác dụng tương hỗ"], correct: 1, explain: "ĐL I nói về quán tính." },
            { id: 2, type: 'theory', q: "Khi ô tô phanh gấp, người ngồi trong xe sẽ:", a: ["Ngả người về sau", "Chúi người về trước", "Ngả sang trái", "Dừng lại ngay"], correct: 1, explain: "Do quán tính bảo toàn vận tốc." },
            { id: 3, type: 'theory', q: "Nếu hợp lực tác dụng lên vật bằng 0 thì vật:", a: ["Đứng yên", "Chuyển động thẳng đều", "Đứng yên hoặc thẳng đều", "Chuyển động chậm dần"], correct: 2, explain: "Theo ĐL I: F=0 => a=0." },
            { id: 4, type: 'theory', q: "Quán tính là tính chất:", a: ["Bảo toàn vận tốc", "Bảo toàn khối lượng", "Bảo toàn lực", "Bảo toàn năng lượng"], correct: 0, explain: "Quán tính chống lại sự thay đổi vận tốc." },
            { id: 21, type: 'theory', q: "Vật nào sau đây chuyển động theo quán tính?", a: ["Vật chuyển động tròn đều", "Vật ném ngang", "Vật chuyển động thẳng đều", "Vật rơi tự do"], correct: 2, explain: "Chuyển động thẳng đều là chuyển động khi F=0 (theo quán tính)." },
            
            // ĐL 2
            { id: 5, type: 'theory', q: "Đại lượng đặc trưng cho mức quán tính là:", a: ["Trọng lượng", "Vận tốc", "Khối lượng", "Lực"], correct: 2, explain: "Khối lượng m lớn thì khó thay đổi vận tốc." },
            { id: 6, type: 'theory', q: "Mối quan hệ giữa lực và gia tốc:", a: ["a tỉ lệ nghịch với F", "a cùng hướng với F", "a ngược hướng với F", "a không phụ thuộc m"], correct: 1, explain: "Gia tốc a luôn cùng hướng với lực F." },
            { id: 7, type: 'theory', q: "Đơn vị lực trong hệ SI:", a: ["kg", "Newton (N)", "Joule (J)", "Watt (W)"], correct: 1, explain: "N là đơn vị lực." },
            { id: 11, type: 'calc', q: "Vật m=2kg chịu lực F=10N. Gia tốc là:", a: ["2 m/s²", "5 m/s²", "20 m/s²", "0.5 m/s²"], correct: 1, explain: "a = F/m = 10/2 = 5." },
            { id: 13, type: 'calc', q: "Vật 5kg có a=2m/s². Lực là:", a: ["2.5 N", "10 N", "7 N", "3 N"], correct: 1, explain: "F = ma = 5*2 = 10." },
            
            // ĐL 3
            { id: 8, type: 'theory', q: "Lực và phản lực:", a: ["Tác dụng cùng một vật", "Cân bằng nhau", "Tác dụng vào hai vật khác nhau", "Khác độ lớn"], correct: 2, explain: "Đặt lên 2 vật khác nhau nên không cân bằng." },
            { id: 9, type: 'theory', q: "Đấm tay vào tường thấy đau do:", a: ["Tường tác dụng lực lại tay", "Tay mềm", "ĐL I", "Quán tính"], correct: 0, explain: "ĐL III: Tường phản lại lực." },
            { id: 10, type: 'theory', q: "Lực và phản lực KHÔNG có đặc điểm:", a: ["Cùng phương", "Ngược chiều", "Cùng độ lớn", "Cùng điểm đặt"], correct: 3, explain: "Điểm đặt khác nhau." },
            
            // Bài tập & Tổng hợp
            { id: 14, type: 'calc', q: "Bóng 0.5kg bay v=10m/s bị đá ngược lại v=20m/s trong 0.1s. Lực là:", a: ["50 N", "100 N", "150 N", "200 N"], correct: 2, explain: "F = m(v2-v1)/t = 0.5*(20 - (-10))/0.1 = 150N." },
            { id: 15, type: 'calc', q: "Người 60kg trên Mặt Trăng (g=1.6) có trọng lượng:", a: ["600 N", "96 N", "37.5 N", "0 N"], correct: 1, explain: "P = mg = 60*1.6 = 96N." },
            { id: 16, type: 'calc', q: "Xe 2 tấn chạy 36km/h hãm phanh sau 5s dừng. Lực hãm:", a: ["-2000 N", "-4000 N", "4000 N", "2000 N"], correct: 2, explain: "v=10m/s. a = -10/5 = -2. F = ma = 2000*2 = 4000N." },
            { id: 22, type: 'theory', q: "Khi vật chuyển động thẳng đều, hợp lực tác dụng là:", a: ["Luôn dương", "Luôn âm", "Bằng 0", "Hằng số khác 0"], correct: 2, explain: "Thẳng đều => a=0 => F=0." },
            { id: 23, type: 'calc', q: "Lực F truyền cho m1 a1=2, m2 a2=6. Truyền cho (m1+m2) gia tốc là:", a: ["1.5 m/s²", "4 m/s²", "8 m/s²", "3 m/s²"], correct: 0, explain: "a = F/(m1+m2) = 1/(1/2 + 1/6) = 1.5." }
        ];

        // --- DATA: PRACTICE PROBLEMS (Restructured for unique SVGs per problem) ---
        const svgArrow = `<marker id="arrow" markerWidth="10" markerHeight="10" refX="9" refY="3" orient="auto" markerUnits="strokeWidth"><path d="M0,0 L0,6 L9,3 z" fill="currentColor" /></marker>`;
        
        const practiceData = [
            {
                id: "topic1",
                title: "Bài 1: Chuyển động trên mặt phẳng ngang không ma sát",
                problems: [
                    {
                        label: "Ví dụ mẫu",
                        q: "Một vật $m = 5kg$ đứng yên trên sàn nhẵn. Tác dụng lực kéo $F_k = 20N$ theo phương ngang. Tính gia tốc và vận tốc sau 4s.",
                        svg: `<line x1="10" y1="90" x2="290" y2="90" stroke="#334155" stroke-width="2"/><rect x="120" y="50" width="60" height="40" fill="#94a3b8" stroke="#475569"/><line x1="150" y1="70" x2="220" y2="70" stroke="#ef4444" stroke-width="3" marker-end="url(#arrow)"/><text x="225" y="75" fill="#ef4444" font-weight="bold" font-size="12">F=20N</text>`,
                        sol: "<p>Chiếu lên phương ngang: $F_k = ma \\Rightarrow a = 20/5 = 4 m/s^2$.</p><p>$v = at = 4 \\cdot 4 = 16 m/s$.</p>"
                    },
                    {
                        label: "Luyện tập 1",
                        q: "Một vật $m=2kg$ đang đứng yên, chịu lực $F$ ngang. Sau $1.5s$ đi được $4.5m$. Tính $F$.",
                        svg: `<line x1="10" y1="90" x2="290" y2="90" stroke="#334155" stroke-width="2"/><rect x="130" y="60" width="40" height="30" fill="#cbd5e1" stroke="#475569"/><line x1="150" y1="75" x2="200" y2="75" stroke="#ef4444" stroke-width="3" marker-end="url(#arrow)"/><text x="205" y="80" fill="#ef4444" font-weight="bold" font-size="12">F=?</text>`,
                        sol: "<p>$s = 0.5at^2 \\Rightarrow 4.5 = 0.5 \\cdot a \\cdot 1.5^2 \\Rightarrow a = 4 m/s^2$.</p><p>$F = ma = 2 \\cdot 4 = 8N$.</p>"
                    },
                    {
                        label: "Luyện tập 2",
                        q: "Lực $F=100N$ tác dụng lên $m$ gây ra $a=2m/s^2$. Nếu $m$ tăng thêm $5kg$, gia tốc mới là bao nhiêu?",
                        svg: `<line x1="10" y1="90" x2="290" y2="90" stroke="#334155" stroke-width="2"/><rect x="100" y="40" width="80" height="50" fill="#64748b" stroke="#475569"/><line x1="140" y1="65" x2="230" y2="65" stroke="#ef4444" stroke-width="3" marker-end="url(#arrow)"/><text x="235" y="70" fill="#ef4444" font-weight="bold" font-size="12">F=100N</text><text x="110" y="65" fill="white" font-size="10">m + 5kg</text>`,
                        sol: "<p>$m = F/a = 100/2 = 50kg$.</p><p>$m' = 55kg$. $a' = F/m' = 100/55 \\approx 1.82 m/s^2$.</p>"
                    }
                ]
            },
            {
                id: "topic2",
                title: "Bài 2: Chuyển động có ma sát",
                problems: [
                    {
                        label: "Ví dụ mẫu",
                        q: "Vật $m = 10kg$, lực kéo $F = 50N$ ngang. $\\mu = 0.2$. Tính gia tốc.",
                        svg: `<line x1="10" y1="90" x2="290" y2="90" stroke="#334155" stroke-width="2"/><rect x="120" y="50" width="60" height="40" fill="#94a3b8"/><line x1="150" y1="70" x2="210" y2="70" stroke="#ef4444" stroke-width="2" marker-end="url(#arrow)"/><line x1="120" y1="90" x2="80" y2="90" stroke="#d97706" stroke-width="2" marker-end="url(#arrow)"/><text x="215" y="75" fill="#ef4444" font-size="12">F</text><text x="60" y="95" fill="#d97706" font-size="12">Fms</text>`,
                        sol: "<p>$F_{ms} = \\mu mg = 0.2 \\cdot 100 = 20N$.</p><p>$a = (F - F_{ms})/m = (50-20)/10 = 3 m/s^2$.</p>"
                    },
                    {
                        label: "Luyện tập 1",
                        q: "Sách $0.5kg$, đẩy $F=2N$ ngang. $\\mu=0.3$. Tính gia tốc.",
                        svg: `<line x1="10" y1="90" x2="290" y2="90" stroke="#334155"/><rect x="130" y="70" width="40" height="20" fill="#fca5a5"/><line x1="150" y1="80" x2="180" y2="80" stroke="#ef4444" marker-end="url(#arrow)"/><line x1="130" y1="90" x2="110" y2="90" stroke="#d97706" marker-end="url(#arrow)"/><text x="185" y="85" font-size="10">F=2N</text>`,
                        sol: "<p>$F_{ms} = 0.3 \\cdot 5 = 1.5N$.</p><p>$a = (2 - 1.5)/0.5 = 1 m/s^2$.</p>"
                    },
                    {
                        label: "Luyện tập 2",
                        q: "Kéo vật $m=20kg$ trượt đều ($a=0$). $\\mu=0.25$. Tính $F$.",
                        svg: `<line x1="10" y1="90" x2="290" y2="90" stroke="#334155"/><rect x="120" y="50" width="60" height="40" fill="#94a3b8"/><line x1="150" y1="70" x2="200" y2="70" stroke="#ef4444" marker-end="url(#arrow)"/><line x1="120" y1="90" x2="70" y2="90" stroke="#d97706" marker-end="url(#arrow)"/><text x="130" y="40" font-size="10">a = 0</text>`,
                        sol: "<p>Trượt đều $\\Rightarrow F = F_{ms} = \\mu mg = 0.25 \\cdot 200 = 50N$.</p>"
                    }
                ]
            },
            {
                id: "topic3",
                title: "Bài 3: Lực kéo xiên góc",
                problems: [
                    {
                        label: "Ví dụ mẫu",
                        q: "Kéo $m=4kg$, $F=20N$ hợp góc $30^\\circ$ lên. Bỏ qua ma sát. Tính $a$.",
                        svg: `<line x1="10" y1="90" x2="290" y2="90" stroke="#334155"/><rect x="120" y="50" width="60" height="40" fill="#94a3b8"/><line x1="150" y1="70" x2="190" y2="45" stroke="#ef4444" stroke-width="2" marker-end="url(#arrow)"/><path d="M 180 70 A 20 20 0 0 0 175 60" fill="none" stroke="black" stroke-dasharray="2"/><text x="195" y="45" fill="#ef4444" font-size="12">F</text><text x="185" y="65" font-size="10">30°</text>`,
                        sol: "<p>$F_x = F\\cos30^\\circ = 10\\sqrt{3}$.</p><p>$a = 10\\sqrt{3}/4 \\approx 4.33 m/s^2$.</p>"
                    },
                    {
                        label: "Luyện tập 1",
                        q: "$m=5kg$, kéo $F=20N$ góc $60^\\circ$. Bỏ qua ma sát. Tính $a$.",
                        svg: `<line x1="10" y1="90" x2="290" y2="90" stroke="#334155"/><rect x="120" y="50" width="60" height="40" fill="#cbd5e1"/><line x1="150" y1="70" x2="170" y2="35" stroke="#ef4444" stroke-width="2" marker-end="url(#arrow)"/><path d="M 170 70 A 20 20 0 0 0 160 55" fill="none" stroke="black" stroke-dasharray="2"/><text x="175" y="35" fill="#ef4444" font-size="12">F</text><text x="175" y="65" font-size="10">60°</text>`,
                        sol: "<p>$a = F\\cos60^\\circ/m = (20 \\cdot 0.5)/5 = 2 m/s^2$.</p>"
                    },
                    {
                        label: "Luyện tập 2",
                        q: "$m=10kg$, kéo $F=40N$ góc $30^\\circ$, $\\mu=0.1$. Tính $a$.",
                        svg: `<line x1="10" y1="90" x2="290" y2="90" stroke="#334155"/><rect x="120" y="50" width="60" height="40" fill="#94a3b8"/><line x1="150" y1="70" x2="190" y2="45" stroke="#ef4444" marker-end="url(#arrow)"/><line x1="120" y1="90" x2="80" y2="90" stroke="#d97706" marker-end="url(#arrow)"/><text x="200" y="50" font-size="12" fill="#ef4444">F</text><text x="60" y="95" font-size="10" fill="#d97706">Fms</text>`,
                        sol: "<p>$N = mg - F\\sin30 = 100 - 20 = 80N$.</p><p>$F_{ms} = 8N$.</p><p>$a = (F\\cos30 - 8)/10 \\approx 2.66 m/s^2$.</p>"
                    }
                ]
            },
            // Topic 4: Mặt phẳng nghiêng (không ma sát)
            {
                id: "topic4",
                title: "Bài 4: Trượt mặt phẳng nghiêng (không ma sát)",
                problems: [
                    {
                        label: "Ví dụ mẫu",
                        q: "Trượt không vận tốc đầu từ đỉnh dốc dài $10m$, góc $30^\\circ$. Tính vận tốc chân dốc.",
                        svg: `<path d="M 20 120 L 220 120 L 220 20 Z" fill="#e2e8f0" stroke="black"/><rect x="150" y="50" width="30" height="20" transform="rotate(-26 165 60)" fill="#94a3b8" stroke="black"/><text x="230" y="120" font-size="12">30°</text>`,
                        sol: "<p>$a = g\\sin30 = 5 m/s^2$.</p><p>$v = \\sqrt{2as} = \\sqrt{100} = 10 m/s$.</p>"
                    },
                    {
                        label: "Luyện tập 1",
                        q: "Trượt dốc $45^\\circ$. Thời gian đi $20m$?",
                        svg: `<path d="M 20 120 L 120 120 L 120 20 Z" fill="#e2e8f0" stroke="black"/><rect x="70" y="60" width="20" height="15" transform="rotate(-45 80 67)" fill="#cbd5e1" stroke="black"/><text x="130" y="120" font-size="12">45°</text>`,
                        sol: "<p>$a = g\\sin45 \\approx 7.07 m/s^2$.</p><p>$20 = 0.5 a t^2 \\Rightarrow t \\approx 2.38s$.</p>"
                    },
                    {
                        label: "Luyện tập 2",
                        q: "Trượt từ độ cao $h=5m$. Tính $v$ chân dốc.",
                        svg: `<path d="M 20 120 L 220 120 L 220 70 Z" fill="#e2e8f0" stroke="black"/><rect x="180" y="70" width="20" height="15" transform="rotate(-14 190 77)" fill="#94a3b8"/><line x1="230" y1="120" x2="230" y2="70" stroke="blue" stroke-dasharray="2"/><text x="235" y="100" font-size="10" fill="blue">h=5m</text>`,
                        sol: "<p>$v = \\sqrt{2gh} = \\sqrt{100} = 10 m/s$.</p>"
                    }
                ]
            },
            // Topic 5: Mặt phẳng nghiêng (có ma sát)
            {
                id: "topic5",
                title: "Bài 5: Trượt mặt phẳng nghiêng (có ma sát)",
                problems: [
                    {
                        label: "Ví dụ mẫu",
                        q: "Bắn lên dốc $30^\\circ$ với $v_0=10m/s$. $\\mu=0.1$. Tính quãng đường.",
                        svg: `<path d="M 20 120 L 220 120 L 220 20 Z" fill="#e2e8f0" stroke="black"/><rect x="180" y="40" width="30" height="20" transform="rotate(-26 195 50)" fill="#94a3b8"/><line x1="180" y1="50" x2="150" y2="65" stroke="#ef4444" marker-end="url(#arrow)"/><text x="130" y="80" font-size="10" fill="#ef4444">v</text>`,
                        sol: "<p>Lên dốc: $a = -(g\\sin30 + \\mu g\\cos30) \\approx -5.87$.</p><p>$s = -100/(2 \\cdot -5.87) \\approx 8.52m$.</p>"
                    },
                    {
                        label: "Luyện tập 1",
                        q: "Trượt xuống dốc $30^\\circ$, $\\mu=0.2$. Tính $a$.",
                        svg: `<path d="M 20 120 L 220 120 L 220 20 Z" fill="#e2e8f0" stroke="black"/><rect x="100" y="70" width="30" height="20" transform="rotate(-26 115 80)" fill="#cbd5e1"/><line x1="120" y1="70" x2="90" y2="60" stroke="#d97706" marker-end="url(#arrow)"/><text x="70" y="55" font-size="10" fill="#d97706">Fms</text>`,
                        sol: "<p>$a = g(\\sin30 - \\mu\\cos30) = 10(0.5 - 0.173) = 3.27 m/s^2$.</p>"
                    },
                    {
                        label: "Luyện tập 2",
                        q: "Trượt xuống đều, góc $30^\\circ$. Tính $\\mu$.",
                        svg: `<path d="M 20 120 L 220 120 L 220 20 Z" fill="#e2e8f0" stroke="black"/><rect x="100" y="70" width="30" height="20" transform="rotate(-26 115 80)" fill="#94a3b8"/><text x="130" y="100" font-size="10">a=0</text>`,
                        sol: "<p>Trượt đều: $\\tan\\alpha = \\mu \\Rightarrow \\mu = \\tan30 \\approx 0.577$.</p>"
                    }
                ]
            },
            // Topic 6: Thang máy
             {
                id: "topic6",
                title: "Bài 6: Thang máy chuyển động",
                problems: [
                    {
                        label: "Ví dụ mẫu",
                        q: "Người $50kg$, thang máy đi lên nhanh dần $a=2m/s^2$. Tính lực nén.",
                        svg: `<rect x="100" y="20" width="100" height="150" fill="none" stroke="black"/><rect x="135" y="120" width="30" height="50" fill="#cbd5e1"/><line x1="210" y1="80" x2="210" y2="40" stroke="blue" marker-end="url(#arrow)"/><text x="215" y="60" fill="blue" font-size="12">a</text>`,
                        sol: "<p>Đi lên nhanh dần: $N = m(g+a) = 50(12) = 600N$.</p>"
                    },
                    {
                        label: "Luyện tập 1",
                        q: "Thang máy đi xuống nhanh dần $a=2m/s^2$. Tính lực nén.",
                        svg: `<rect x="100" y="20" width="100" height="150" fill="none" stroke="black"/><rect x="135" y="120" width="30" height="50" fill="#cbd5e1"/><line x1="210" y1="100" x2="210" y2="140" stroke="blue" marker-end="url(#arrow)"/><text x="215" y="130" fill="blue" font-size="12">a</text>`,
                        sol: "<p>Đi xuống nhanh dần: $N = m(g-a) = 50(8) = 400N$.</p>"
                    },
                    {
                        label: "Luyện tập 2",
                        q: "Thang máy rơi tự do. Lực nén?",
                        svg: `<rect x="100" y="20" width="100" height="150" fill="none" stroke="black"/><rect x="135" y="120" width="30" height="50" fill="#fca5a5"/><line x1="210" y1="100" x2="210" y2="150" stroke="red" stroke-width="2" marker-end="url(#arrow)"/><text x="215" y="130" fill="red" font-size="12">a=g</text>`,
                        sol: "<p>Rơi tự do $a=g \Rightarrow N = m(g-g) = 0N$.</p>"
                    }
                ]
            },
            // Topic 7: Hãm phanh
            {
                id: "topic7",
                title: "Bài 7: Lực hãm phanh",
                problems: [
                    {
                        label: "Ví dụ mẫu",
                        q: "Xe 2 tấn, $72km/h$, hãm phanh đi $50m$ dừng. Tính $F_h$.",
                        svg: `<rect x="80" y="60" width="80" height="40" fill="#94a3b8"/><line x1="80" y1="80" x2="40" y2="80" stroke="red" marker-end="url(#arrow)"/><text x="40" y="70" fill="red">Fh</text><line x1="10" y1="100" x2="290" y2="100" stroke="black"/>`,
                        sol: "<p>$a = -20^2/100 = -4$. $F_h = 2000 \\cdot 4 = 8000N$.</p>"
                    },
                    {
                        label: "Luyện tập 1",
                        q: "Xe 10 tấn, $36km/h$, hãm $5000N$. Bao lâu dừng?",
                        svg: `<rect x="80" y="60" width="100" height="40" fill="#cbd5e1"/><line x1="80" y1="80" x2="50" y2="80" stroke="red" marker-end="url(#arrow)"/><text x="50" y="70" fill="red" font-size="10">5000N</text><line x1="10" y1="100" x2="290" y2="100" stroke="black"/>`,
                        sol: "<p>$a = -5000/10000 = -0.5$. $t = -10/-0.5 = 20s$.</p>"
                    },
                    {
                        label: "Luyện tập 2",
                        q: "Trượt $20m$ từ $10m/s$ thì dừng. Tính $\\mu$.",
                        svg: `<rect x="80" y="60" width="80" height="40" fill="#fca5a5"/><line x1="80" y1="100" x2="50" y2="100" stroke="#d97706" marker-end="url(#arrow)"/><text x="40" y="115" fill="#d97706">Fms</text><line x1="10" y1="100" x2="290" y2="100" stroke="black"/>`,
                        sol: "<p>$a = -100/40 = -2.5$. $\\mu = |a|/g = 0.25$.</p>"
                    }
                ]
            },
            // Topic 8: Hệ vật
            {
                id: "topic8",
                title: "Bài 8: Hệ vật & Lực căng dây",
                problems: [
                    {
                        label: "Ví dụ mẫu",
                        q: "$m_1=2, m_2=3$, nối dây, kéo $m_2$ với $F=10N$. Tính $T$.",
                        svg: `<rect x="50" y="60" width="30" height="30" fill="#cbd5e1" stroke="black"/><line x1="80" y1="75" x2="120" y2="75" stroke="black"/><rect x="120" y="60" width="40" height="30" fill="#94a3b8" stroke="black"/><line x1="160" y1="75" x2="200" y2="75" stroke="red" marker-end="url(#arrow)"/><text x="205" y="80" fill="red">F</text>`,
                        sol: "<p>$a = 10/5 = 2$. $T = m_1a = 4N$.</p>"
                    },
                    {
                        label: "Luyện tập 1",
                        q: "$m_1=2, m_2=3$ sát nhau. Đẩy $m_1$ lực $10N$. Tính lực tương tác.",
                        svg: `<rect x="80" y="60" width="30" height="30" fill="#cbd5e1" stroke="black"/><rect x="110" y="60" width="40" height="30" fill="#94a3b8" stroke="black"/><line x1="50" y1="75" x2="80" y2="75" stroke="red" marker-end="url(#arrow)"/><text x="40" y="80" fill="red">F</text>`,
                        sol: "<p>$a = 2$. Lực $m_1$ đẩy $m_2$: $F_{12} = m_2a = 6N$.</p>"
                    },
                    {
                        label: "Luyện tập 2",
                        q: "Ròng rọc treo $m_1=3, m_2=2$. Tính $T$.",
                        svg: `<circle cx="150" cy="40" r="15" fill="none" stroke="black"/><line x1="135" y1="40" x2="135" y2="100" stroke="black"/><rect x="125" y="100" width="20" height="20" fill="#94a3b8"/><line x1="165" y1="40" x2="165" y2="80" stroke="black"/><rect x="155" y="80" width="20" height="20" fill="#cbd5e1"/><text x="110" y="110">m1</text><text x="180" y="90">m2</text>`,
                        sol: "<p>$a = g(3-2)/5 = 2$. $T = m_2(g+a) = 24N$.</p>"
                    }
                ]
            },
            // Topic 9: Rơi có lực cản
            {
                id: "topic9",
                title: "Bài 9: Rơi chịu lực cản",
                problems: [
                    {
                        label: "Ví dụ mẫu",
                        q: "Vật $2kg$ rơi, $F_c=4N$. Tính $a$.",
                        svg: `<circle cx="150" cy="50" r="15" fill="#94a3b8"/><line x1="150" y1="50" x2="150" y2="90" stroke="blue" marker-end="url(#arrow)"/><line x1="150" y1="35" x2="150" y2="15" stroke="red" marker-end="url(#arrow)"/><text x="160" y="80" fill="blue">P</text><text x="160" y="25" fill="red">Fc</text>`,
                        sol: "<p>$a = (mg - F_c)/m = (20-4)/2 = 8 m/s^2$.</p>"
                    },
                    {
                        label: "Luyện tập 1",
                        q: "Mưa rơi đều ($a=0$), $m=0.01g$. Tính $F_c$.",
                        svg: `<circle cx="150" cy="50" r="5" fill="blue"/><line x1="150" y1="50" x2="150" y2="70" stroke="black" marker-end="url(#arrow)"/><line x1="150" y1="45" x2="150" y2="25" stroke="red" marker-end="url(#arrow)"/><text x="160" y="60" font-size="10">P</text><text x="160" y="35" font-size="10" fill="red">Fc</text>`,
                        sol: "<p>$a=0 \Rightarrow F_c = P = 10^{-4}N$.</p>"
                    },
                    {
                        label: "Luyện tập 2",
                        q: "Ném lên, $F_c=2N$, $m=1kg$. Tính $a$ khi lên.",
                        svg: `<circle cx="150" cy="80" r="15" fill="#cbd5e1"/><line x1="150" y1="80" x2="150" y2="120" stroke="blue" marker-end="url(#arrow)"/><line x1="150" y1="80" x2="150" y2="100" stroke="red" marker-end="url(#arrow)" transform="translate(10,0)"/><text x="160" y="115" fill="blue">P</text><text x="170" y="95" fill="red">Fc</text>`,
                        sol: "<p>$a = (P + F_c)/m = 12 m/s^2$ (hướng xuống).</p>"
                    }
                ]
            },
            // Topic 10: Tổng hợp lực
            {
                id: "topic10",
                title: "Bài 10: Tổng hợp lực",
                problems: [
                    {
                        label: "Ví dụ mẫu",
                        q: "$F_1=6N, F_2=8N$ vuông góc. Tính hợp lực.",
                        svg: `<line x1="100" y1="100" x2="160" y2="100" stroke="red" marker-end="url(#arrow)"/><line x1="100" y1="100" x2="100" y2="40" stroke="red" marker-end="url(#arrow)"/><line x1="100" y1="100" x2="160" y2="40" stroke="blue" stroke-dasharray="2" marker-end="url(#arrow)"/><text x="170" y="105" fill="red">F1</text><text x="90" y="35" fill="red">F2</text>`,
                        sol: "<p>$F = \\sqrt{6^2+8^2} = 10N$.</p>"
                    },
                    {
                        label: "Luyện tập 1",
                        q: "$F_1=3, F_2=4$, góc $60^\\circ$. Tính $F$.",
                        svg: `<line x1="100" y1="100" x2="150" y2="100" stroke="red" marker-end="url(#arrow)"/><line x1="100" y1="100" x2="130" y2="50" stroke="red" marker-end="url(#arrow)"/><text x="155" y="105" font-size="10">F1</text><text x="135" y="45" font-size="10">F2</text><text x="110" y="90" font-size="10">60°</text>`,
                        sol: "<p>$F = \\sqrt{9+16+12} = \\sqrt{37} \\approx 6.08N$.</p>"
                    },
                    {
                        label: "Luyện tập 2",
                        q: "$F_1=F_2=10N$, góc $120^\\circ$. Tính $F$.",
                        svg: `<line x1="100" y1="100" x2="150" y2="100" stroke="red" marker-end="url(#arrow)"/><line x1="100" y1="100" x2="75" y2="57" stroke="red" marker-end="url(#arrow)"/><text x="155" y="105" font-size="10">F1</text><text x="70" y="50" font-size="10">F2</text><text x="105" y="90" font-size="10">120°</text>`,
                        sol: "<p>Góc $120^\\circ$, lực bằng nhau $\\Rightarrow F = F_1 = 10N$.</p>"
                    }
                ]
            }
        ];

        // --- GLOBAL STATE ---
        let currentQuizQuestions = [];
        let userScore = 0;
        let usedQuestionsIndices = []; // To track used questions within session if needed, but we rely on shuffle

        // --- FUNCTIONS ---
        function showTab(tabId) {
            document.querySelectorAll('.tab-content').forEach(el => el.classList.remove('active'));
            document.getElementById(tabId).classList.add('active');
            window.scrollTo(0, 0);
            if(window.MathJax && window.MathJax.typesetPromise) window.MathJax.typesetPromise();
        }

        function toggleMobileMenu() {
            const menu = document.getElementById('mobile-menu');
            if(menu.classList.contains('hidden')) {
                menu.classList.remove('hidden');
                setTimeout(() => menu.classList.add('opacity-100'), 10);
            } else {
                menu.classList.add('hidden');
            }
        }

        function toggleSummaryModal() {
            const modal = document.getElementById('summary-modal');
            if (modal.classList.contains('hidden')) {
                modal.classList.remove('hidden');
                setTimeout(() => modal.classList.remove('opacity-0'), 10);
                if(window.MathJax) MathJax.typesetPromise([modal]);
            } else {
                modal.classList.add('opacity-0');
                setTimeout(() => modal.classList.add('hidden'), 300);
            }
        }

        // Updated Load Practice to render 3 cards per topic
        function loadPractice() {
            const container = document.getElementById('practice-container');
            container.innerHTML = practiceData.map((topic, index) => `
                <div class="bg-white rounded-2xl shadow-sm border border-slate-200 overflow-hidden mb-8">
                    <div class="bg-blue-50/50 p-4 border-b border-blue-100">
                        <h3 class="font-bold text-lg text-blue-800">${topic.title}</h3>
                    </div>
                    <div class="p-6 grid gap-8">
                        ${topic.problems.map((prob, i) => `
                            <div class="bg-white border border-slate-200 rounded-xl overflow-hidden hover:shadow-md transition">
                                <div class="bg-slate-50 px-4 py-2 border-b border-slate-200 flex justify-between items-center">
                                    <span class="text-xs font-bold uppercase tracking-wider ${i===0 ? 'text-blue-600' : 'text-slate-600'}">${prob.label}</span>
                                </div>
                                <div class="p-4 grid md:grid-cols-3 gap-6">
                                    <div class="md:col-span-2">
                                        <div class="mb-4 text-slate-800 font-medium">${prob.q}</div>
                                        <button onclick="toggleSol('${topic.id}-${i}')" class="text-sm font-bold text-blue-600 hover:text-blue-800 flex items-center">
                                            <i class="fa-solid fa-key mr-2"></i>Xem lời giải
                                        </button>
                                        <div id="sol-${topic.id}-${i}" class="hidden mt-3 p-3 bg-green-50 rounded-lg text-sm text-slate-700 border border-green-100 animate-fadeIn">
                                            ${prob.sol}
                                        </div>
                                    </div>
                                    <div class="flex items-center justify-center bg-white border border-slate-100 rounded-lg p-2 h-32">
                                        <svg width="100%" height="100%" viewBox="0 0 300 150" preserveAspectRatio="xMidYMid meet">
                                            ${svgArrow}
                                            ${prob.svg}
                                        </svg>
                                    </div>
                                </div>
                            </div>
                        `).join('')}
                    </div>
                </div>
            `).join('');
            if(window.MathJax) MathJax.typesetPromise([container]);
        }

        function toggleSol(id) {
            document.getElementById(`sol-${id}`).classList.toggle('hidden');
        }

        // --- QUIZ LOGIC (No Duplicates) ---
        function shuffleArray(array) {
            for (let i = array.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [array[i], array[j]] = [array[j], array[i]];
            }
            return array;
        }

        function startQuiz() {
            // Check previous session data to minimize cross-session repeats (optional enhancement)
            let allIndices = Array.from({length: quizBank.length}, (_, i) => i);
            
            // Simple Shuffle
            let shuffledIndices = shuffleArray(allIndices);
            
            // Select first 10
            let selectedIndices = shuffledIndices.slice(0, 10);
            
            currentQuizQuestions = selectedIndices.map(i => quizBank[i]);
            userScore = 0;
            
            document.getElementById('quiz-status').classList.remove('hidden');
            document.getElementById('current-score').innerText = '0';
            document.getElementById('quiz-progress-bar').style.width = '0%';
            
            renderQuiz();
        }

        function renderQuiz() {
            const container = document.getElementById('quiz-container');
            container.innerHTML = currentQuizQuestions.map((q, index) => `
                <div class="bg-white p-8 rounded-2xl shadow-sm border border-slate-200 quiz-card relative" id="q-card-${index}">
                    <div class="flex justify-between items-start mb-6">
                         <div class="inline-flex items-center justify-center w-8 h-8 rounded-full bg-slate-100 text-slate-600 font-bold text-sm mr-4 border border-slate-200">${index + 1}</div>
                         <div class="px-2 py-1 rounded text-xs font-bold uppercase border ${q.type === 'theory' ? 'bg-blue-50 text-blue-600 border-blue-100' : 'bg-purple-50 text-purple-600 border-purple-100'}">${q.type === 'theory' ? 'Lý thuyết' : 'Bài tập'}</div>
                    </div>
                    <p class="font-bold text-lg mb-6 text-slate-800">${q.q}</p>
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-3" id="options-${index}">
                        ${q.a.map((opt, optIndex) => `
                            <button onclick="answerQuestion(${index}, ${optIndex})" class="quiz-option text-left p-3 rounded-xl border border-slate-200 bg-white hover:border-blue-300 flex items-center group h-full">
                                <span class="flex-shrink-0 w-6 h-6 rounded-full bg-slate-50 text-slate-500 font-bold text-xs flex items-center justify-center mr-3 border border-slate-200 group-hover:bg-blue-50 group-hover:text-blue-600">${String.fromCharCode(65 + optIndex)}</span>
                                <span class="text-slate-700 text-sm font-medium">${opt}</span>
                            </button>
                        `).join('')}
                    </div>
                    <div id="feedback-${index}" class="hidden mt-4 p-4 rounded-xl bg-slate-50 border border-slate-100 animate-fadeIn text-sm">
                        <div class="flex items-center gap-2 mb-1 status-text font-bold"></div>
                        <div class="text-slate-600 explain-text pl-6"></div>
                    </div>
                </div>
            `).join('');
            if(window.MathJax) MathJax.typesetPromise([container]);
            document.getElementById('quiz-status').scrollIntoView({behavior: 'smooth', block: 'start'});
        }

        function answerQuestion(qIndex, choiceIndex) {
            const questionData = currentQuizQuestions[qIndex];
            const card = document.getElementById(`q-card-${qIndex}`);
            const buttons = card.querySelectorAll('.quiz-option');
            const feedback = document.getElementById(`feedback-${qIndex}`);
            
            buttons.forEach(btn => {
                btn.disabled = true;
                btn.classList.add('cursor-default');
            });

            const isCorrect = choiceIndex === questionData.correct;
            
            if(isCorrect) {
                buttons[choiceIndex].classList.add('correct');
                userScore++;
                feedback.querySelector('.status-text').innerHTML = `<span class="text-green-600">Chính xác!</span>`;
            } else {
                buttons[choiceIndex].classList.add('wrong');
                buttons[questionData.correct].classList.add('correct');
                feedback.querySelector('.status-text').innerHTML = `<span class="text-red-600">Sai rồi!</span>`;
            }

            feedback.querySelector('.explain-text').innerHTML = questionData.explain;
            feedback.classList.remove('hidden');

            document.getElementById('current-score').innerText = userScore;
            const percent = ((document.querySelectorAll('.quiz-option:disabled').length / 4) / currentQuizQuestions.length) * 100;
            document.getElementById('quiz-progress-bar').style.width = `${percent}%`;
            
            if(window.MathJax) MathJax.typesetPromise([feedback]);
        }

        window.onload = function() {
            loadPractice();
        };
    </script>
</body>
</html>
