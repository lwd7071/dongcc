<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>H·ªá Th·ªëng Luy·ªán Thi Python (5 ƒê·ªÅ ƒê·ªôc L·∫≠p)</title>
    <style>
        :root {
            --primary-color: #2c3e50;
            --secondary-color: #3498db;
            --accent-color: #e74c3c;
            --bg-color: #f5f6fa;
            --text-color: #2c3e50;
            --success-color: #27ae60;
            --border-radius: 8px;
        }

        body { font-family: 'Segoe UI', sans-serif; background-color: var(--bg-color); color: var(--text-color); margin: 0; padding: 0; line-height: 1.6; }
        
        header { background-color: var(--primary-color); color: white; padding: 1rem 2rem; position: sticky; top: 0; z-index: 1000; box-shadow: 0 2px 5px rgba(0,0,0,0.1); display: flex; justify-content: space-between; align-items: center; }
        h1 { margin: 0; font-size: 1.5rem; }
        .nav-tabs { display: flex; gap: 10px; flex-wrap: wrap; }
        .nav-btn { background: rgba(255,255,255,0.1); border: none; color: white; padding: 8px 15px; cursor: pointer; border-radius: 4px; transition: all 0.3s; }
        .nav-btn:hover, .nav-btn.active { background: var(--secondary-color); font-weight: bold; }
        
        .timer-panel { background: white; padding: 8px 15px; border-radius: 20px; font-weight: bold; color: var(--accent-color); display: flex; align-items: center; gap: 5px; min-width: 100px; justify-content: center;}

        main { max-width: 1000px; margin: 2rem auto; padding: 0 20px 80px 20px; }
        
        .intro-card { background: white; padding: 2rem; border-radius: var(--border-radius); text-align: center; box-shadow: 0 4px 6px rgba(0,0,0,0.05); }
        
        .section-header { background: #dfe6e9; padding: 10px 15px; border-left: 5px solid var(--secondary-color); margin: 30px 0 15px 0; font-weight: bold; text-transform: uppercase; }
        
        .question-card { background: white; padding: 20px; margin-bottom: 20px; border-radius: var(--border-radius); border: 1px solid #eee; box-shadow: 0 2px 4px rgba(0,0,0,0.05); }
        .q-title { font-weight: 600; margin-bottom: 15px; display: flex; gap: 10px; }
        .q-number { background: var(--primary-color); color: white; padding: 2px 8px; border-radius: 4px; font-size: 0.9em; height: fit-content; min-width: 60px; text-align: center; }
        
        .q-code-block { background: #282c34; color: #abb2bf; padding: 15px; border-radius: 6px; font-family: 'Consolas', monospace; white-space: pre-wrap; margin: 10px 0; font-size: 0.9em; overflow-x: auto; tab-size: 4; }
        
        .options-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 10px; }
        .option-label { display: flex; align-items: flex-start; padding: 10px; border: 2px solid #e0e0e0; border-radius: 6px; cursor: pointer; transition: all 0.2s; }
        .option-label:hover { border-color: var(--secondary-color); background: #f7fbff; }
        .option-input { margin-right: 10px; margin-top: 5px; }
        
        .correct-answer { border-color: var(--success-color) !important; background-color: #e8f8f5 !important; }
        .wrong-answer { border-color: var(--accent-color) !important; background-color: #fdedec !important; }
        .explanation { margin-top: 15px; padding: 10px; background: #fff3cd; border-left: 4px solid #ffc107; border-radius: 4px; display: none; font-size: 0.95em; }

        .actions { position: fixed; bottom: 0; left: 0; right: 0; background: white; padding: 15px; box-shadow: 0 -2px 10px rgba(0,0,0,0.1); display: flex; justify-content: center; gap: 20px; z-index: 999; }
        .btn { padding: 10px 25px; border: none; border-radius: 5px; cursor: pointer; font-weight: bold; font-size: 1rem; transition: transform 0.1s; color: white;}
        .btn:active { transform: scale(0.98); }
        .btn-submit { background: var(--success-color); }
        .btn-reset { background: var(--accent-color); }
        .btn-secondary { background: #95a5a6; }
        .btn-primary { background: var(--secondary-color); }

        .score-board { position: fixed; top: 50%; left: 50%; transform: translate(-50%, -50%); background: white; padding: 30px; border-radius: 15px; box-shadow: 0 5px 30px rgba(0,0,0,0.3); text-align: center; z-index: 2000; display: none; min-width: 300px; }
        .overlay { position: fixed; top: 0; left: 0; right: 0; bottom: 0; background: rgba(0,0,0,0.5); z-index: 1999; display: none; }

        @media (max-width: 768px) {
            .options-grid { grid-template-columns: 1fr; }
            header { flex-direction: column; gap: 10px; }
            .nav-tabs { justify-content: center; }
        }
    </style>
</head>
<body>

    <header>
        <h1>üêç Luy·ªán Thi Python</h1>
        <div class="nav-tabs" id="navTabs"></div>
        <div class="timer-panel">
            <span>‚è±Ô∏è</span>
            <span id="timerDisplay">60:00</span>
        </div>
    </header>

    <main id="mainContent">
        <!-- Content will be injected here -->
    </main>

    <div class="actions" id="actionPanel" style="display: none;">
        <button class="btn btn-submit" onclick="submitQuiz()">N·ªôp B√†i</button>
        <button class="btn btn-reset" onclick="resetQuiz()">L√†m L·∫°i</button>
    </div>

    <div class="overlay" id="overlay"></div>
    <div class="score-board" id="scoreBoard">
        <h2 style="color: var(--primary-color);">K·∫øt Qu·∫£</h2>
        <div style="font-size: 3rem; color: var(--success-color); margin: 20px 0;" id="scoreText">0/50</div>
        <p id="scoreMessage">...</p>
        <div style="display: flex; gap: 10px; justify-content: center; margin-top: 20px;">
            <button class="btn btn-secondary" onclick="closeScoreAndReview()">Xem Chi Ti·∫øt</button>
            <button class="btn btn-primary" onclick="backToMenu()">Ch·ªçn ƒê·ªÅ Kh√°c</button>
        </div>
    </div>

    <script>
        // --- D·ªÆ LI·ªÜU ƒê·ªÄ THI ƒê·ªòC L·∫¨P (5 SETS) ---
        // C·∫•u tr√∫c c√¢u h·ªèi: [Type, Question, Code, Options, CorrectIndex, Explanation]
        // Type: 0=LT C∆° b·∫£n, 1=LT Packages, 2=Output, 3=Matplotlib, 4=FillCode, 5=Debug

        const questionTypes = {
            0: "I. L√ù THUY·∫æT - KH√ÅI NI·ªÜM C∆† B·∫¢N",
            1: "I. L√ù THUY·∫æT - PACKAGES (NUMPY, PANDAS, MATPLOTLIB)",
            2: "II. TH·ª∞C H√ÄNH - ƒê·ªåC K·∫æT QU·∫¢ (OUTPUT)",
            3: "II. TH·ª∞C H√ÄNH - BI·ªÇU ƒê·ªí MATPLOTLIB",
            4: "II. TH·ª∞C H√ÄNH - ƒêI·ªÄN CODE",
            5: "II. TH·ª∞C H√ÄNH - T√åM L·ªñI SAI"
        };

        const de1 = [
            // LT C∆° b·∫£n (V√≠ d·ª• ƒë·∫°i di·ªán)
            [0, "Thu·∫≠t to√°n c·∫ßn ƒë·∫£m b·∫£o t√≠nh ch·∫•t n√†o?", null, ["T√≠nh ng·∫´u nhi√™n", "T√≠nh x√°c ƒë·ªãnh", "T√≠nh m∆° h·ªì", "T√≠nh l·∫∑p v√¥ h·∫°n"], 1, "Thu·∫≠t to√°n ph·∫£i r√µ r√†ng, x√°c ƒë·ªãnh."],
            [0, "K·∫øt qu·∫£ c·ªßa `10 // 3`?", null, ["3.33", "3", "4", "3.0"], 1, "// l√† ph√©p chia l·∫•y ph·∫ßn nguy√™n."],
            [0, "H√†m `len()` d√πng ƒë·ªÉ l√†m g√¨?", null, ["T√≠nh t·ªïng", "ƒê·∫øm s·ªë ph·∫ßn t·ª≠", "S·∫Øp x·∫øp", "X√≥a"], 1, "Tr·∫£ v·ªÅ ƒë·ªô d√†i container."],
            [0, "Ki·ªÉu d·ªØ li·ªáu c·ªßa `x = (1,)`?", null, ["int", "tuple", "list", "set"], 1, "D·∫•u ph·∫©y t·∫°o n√™n tuple ƒë∆°n."],
            [0, "V√≤ng l·∫∑p `while True` ch·∫°y bao nhi√™u l·∫ßn?", null, ["0", "1", "V√¥ h·∫°n (n·∫øu kh√¥ng break)", "L·ªói"], 2, "ƒêi·ªÅu ki·ªán lu√¥n ƒë√∫ng."],
            // ... (Th√™m 15 c√¢u c∆° b·∫£n kh√°c cho ƒë·ªß 20)
            [0, "List l√† ki·ªÉu d·ªØ li·ªáu?", null, ["Immutable", "Mutable", "Constant", "Static"], 1, "List c√≥ th·ªÉ thay ƒë·ªïi."],
            [0, "T·ª´ kh√≥a ƒë·ªãnh nghƒ©a h√†m?", null, ["func", "function", "def", "define"], 2, "def function_name():"],
            [0, "ƒê·ªÉ nh·∫≠p d·ªØ li·ªáu t·ª´ b√†n ph√≠m?", null, ["get()", "scan()", "input()", "read()"], 2, "input() tr·∫£ v·ªÅ chu·ªói."],
            [0, "To√°n t·ª≠ `**` nghƒ©a l√†?", null, ["Nh√¢n", "Chia", "L≈©y th·ª´a", "CƒÉn"], 2, "2**3 = 8"],
            [0, "Dictionary truy xu·∫•t b·∫±ng?", null, ["Index", "Key", "Value", "Order"], 1, "d[key]"],
            [0, "Set ch·ª©a ph·∫ßn t·ª≠ tr√πng l·∫∑p?", null, ["C√≥", "Kh√¥ng", "T√πy √Ω", "L·ªói"], 1, "Set lo·∫°i b·ªè tr√πng l·∫∑p."],
            [0, "Module l√† g√¨?", null, ["M·ªôt file .py", "M·ªôt th∆∞ m·ª•c", "M·ªôt h√†m", "M·ªôt bi·∫øn"], 0, "File ch·ª©a code Python."],
            [0, "Class l√† khu√¥n m·∫´u t·∫°o ra?", null, ["Module", "Object", "Function", "Package"], 1, "ƒê·ªëi t∆∞·ª£ng (Instance)."],
            [0, "H√†m `range(5)` t·∫°o sequence?", null, ["1,2,3,4,5", "0,1,2,3,4", "0,1,2,3,4,5", "1,2,3,4"], 1, "B·∫Øt ƒë·∫ßu t·ª´ 0, kh√¥ng bao g·ªìm stop."],
            [0, "Bi·∫øn to√†n c·ª•c khai b√°o b·∫±ng?", null, ["local", "global", "static", "const"], 1, "global x"],
            [0, "if..elif..else l√† c·∫•u tr√∫c?", null, ["L·∫∑p", "R·∫Ω nh√°nh", "Tu·∫ßn t·ª±", "H√†m"], 1, "ƒêi·ªÅu ki·ªán r·∫Ω nh√°nh."],
            [0, "Chu·ªói ƒë·∫∑t trong?", null, ["()", "[]", "'' ho·∫∑c \"\"", "{}"], 2, "D·∫•u nh√°y ƒë∆°n ho·∫∑c k√©p."],
            [0, "K√Ω t·ª± xu·ªëng d√≤ng?", null, ["\\t", "\\n", "\\r", "\\b"], 1, "Newline."],
            [0, "Comment 1 d√≤ng d√πng?", null, ["//", "/*", "#", "--"], 2, "D·∫•u thƒÉng."],
            [0, "√âp ki·ªÉu sang s·ªë nguy√™n?", null, ["str()", "float()", "int()", "bool()"], 2, "int()"],

            // LT Packages (6 c√¢u)
            [1, "Numpy chuy√™n v·ªÅ?", null, ["Web", "X·ª≠ l√Ω ·∫£nh", "T√≠nh to√°n m·∫£ng s·ªë h·ªçc", "Game"], 2, "Numerical Python."],
            [1, "C·∫•u tr√∫c 2 chi·ªÅu c·ªßa Pandas?", null, ["Series", "List", "DataFrame", "Panel"], 2, "B·∫£ng d·ªØ li·ªáu."],
            [1, "Matplotlib: H√†m v·∫Ω bi·ªÉu ƒë·ªì ƒë∆∞·ªùng?", null, ["bar()", "scatter()", "plot()", "hist()"], 2, "plot() m·∫∑c ƒë·ªãnh v·∫Ω line."],
            [1, "T·∫°o m·∫£ng Numpy s·ªë 0?", null, ["zeros()", "ones()", "empty()", "null()"], 0, "np.zeros()"],
            [1, "ƒê·ªçc file CSV trong Pandas?", null, ["read_excel", "read_csv", "read_sql", "read_json"], 1, "pd.read_csv()"],
            [1, "Thu·ªôc t√≠nh k√≠ch th∆∞·ªõc m·∫£ng Numpy?", null, ["size", "len", "shape", "dim"], 2, "Tr·∫£ v·ªÅ tuple (rows, cols)."],

            // Th·ª±c h√†nh - Output (10 c√¢u)
            [2, "K·∫øt qu·∫£?", "x = 10\nprint(x > 5 and x < 15)", ["True", "False", "None", "Error"], 0, "10 n·∫±m trong kho·∫£ng (5, 15)."],
            [2, "K·∫øt qu·∫£?", "l = [1, 2, 3]\nl.append([4])\nprint(len(l))", ["3", "4", "5", "L·ªói"], 1, "[4] ƒë∆∞·ª£c th√™m v√†o nh∆∞ 1 ph·∫ßn t·ª≠. Len = 4."],
            [2, "K·∫øt qu·∫£?", "s = 'Hello'\nprint(s[1])", ["H", "e", "l", "o"], 1, "Index 1 l√† k√Ω t·ª± th·ª© 2."],
            [2, "K·∫øt qu·∫£?", "def f(x=2): return x*x\nprint(f())", ["2", "4", "0", "L·ªói"], 1, "D√πng default x=2 -> 2*2=4."],
            [2, "K·∫øt qu·∫£?", "d = {'a': 1}\nd['b'] = 2\nprint(d)", ["{'a': 1}", "{'b': 2}", "{'a': 1, 'b': 2}", "L·ªói"], 2, "Th√™m key m·ªõi v√†o dict."],
            [2, "Numpy Output?", "import numpy as np\na = np.array([1, 2])\nprint(a + 1)", ["[1, 2, 1]", "[2, 3]", "Error", "[1, 2]"], 1, "Broadcasting c·ªông 1 v√†o t·ª´ng ph·∫ßn t·ª≠."],
            [2, "K·∫øt qu·∫£?", "for i in range(2):\n print(i, end='')", ["01", "12", "012", "1"], 0, "Ch·∫°y 0, 1."],
            [2, "Class Output?", "class A: x=1\na = A()\na.x = 2\nprint(A.x, a.x)", ["1 1", "2 2", "1 2", "2 1"], 2, "A.x l√† class var (1), a.x l√† instance var (2)."],
            [2, "Try-Except?", "try: int('a')\nexcept: print(1)\nelse: print(2)", ["1", "2", "1 2", "Error"], 0, "L·ªói ValueError -> nh·∫£y v√†o except in 1."],
            [2, "Pandas?", "import pandas as pd\ns = pd.Series([10, 20], index=['a', 'b'])\nprint(s['a'])", ["10", "20", "0", "KeyError"], 0, "Truy c·∫≠p theo label index."],

            // Matplotlib (2 c√¢u)
            [3, "H√†m `plt.bar()` v·∫Ω bi·ªÉu ƒë·ªì g√¨?", null, ["ƒê∆∞·ªùng", "C·ªôt", "Tr√≤n", "Ph√¢n t√°n"], 1, "Bar chart."],
            [3, "L·ªánh ƒë·∫∑t ti√™u ƒë·ªÅ bi·ªÉu ƒë·ªì?", null, ["plt.header()", "plt.name()", "plt.title()", "plt.text()"], 2, "title()."],

            // ƒêi·ªÅn code (6 c√¢u)
            [4, "ƒêi·ªÅn ƒë·ªÉ import numpy:", "import numpy ___ np", ["is", "to", "as", "in"], 2, "Alias."],
            [4, "ƒêi·ªÅn ƒë·ªÉ t·∫°o list r·ªóng:", "lst = ___", ["()", "[]", "{}", "set()"], 1, "Ngo·∫∑c vu√¥ng."],
            [4, "ƒêi·ªÅn ƒë·ªÉ l·∫∑p qua dict:", "for k, v in d.___():", ["items", "keys", "values", "entry"], 0, "items() tr·∫£ v·ªÅ c·∫∑p key, value."],
            [4, "ƒêi·ªÅn m·ªü file ghi:", "open('f.txt', '___')", ["r", "w", "rb", "read"], 1, "Write mode."],
            [4, "ƒêi·ªÅn k·∫ø th·ª´a:", "class Con(___):", ["Cha", "extends Cha", "super Cha", "Cha()"], 0, "class Con(Cha)"],
            [4, "ƒêi·ªÅn ki·ªÉm tra t·ªìn t·∫°i:", "if x ___ list:", ["exist", "has", "in", "find"], 2, "To√°n t·ª≠ in."],

            // T√¨m l·ªói (6 c√¢u)
            [5, "L·ªói c√∫ ph√°p?", "if x = 5:", ["Thi·∫øu :", "Sai ph√©p so s√°nh", "Sai if", "Kh√¥ng l·ªói"], 1, "Ph·∫£i d√πng == ƒë·ªÉ so s√°nh."],
            [5, "L·ªói th·ª•t l·ªÅ?", "def f():\nprint(1)", ["NameError", "IndentationError", "SyntaxError", "TypeError"], 1, "Th√¢n h√†m ph·∫£i th·ª•t v√†o."],
            [5, "L·ªói bi·∫øn?", "print(bien_chua_co)", ["NameError", "ValueError", "TypeError", "IndexError"], 0, "Bi·∫øn ch∆∞a ƒë·ªãnh nghƒ©a."],
            [5, "L·ªói index?", "l=[1]\nprint(l[1])", ["KeyError", "IndexError", "ValueError", "TypeError"], 1, "Index 1 v∆∞·ª£t qu√° len 1 (max index 0)."],
            [5, "L·ªói ki·ªÉu?", "print('1' + 1)", ["SyntaxError", "TypeError", "ValueError", "NameError"], 1, "Kh√¥ng c·ªông chu·ªói v·ªõi s·ªë."],
            [5, "L·ªói chia 0?", "x = 1/0", ["ZeroDivisionError", "ValueError", "MathError", "CalcError"], 0, "Chia cho 0."]
        ];

        const de2 = [
            // Thay ƒë·ªïi ch·ªß ƒë·ªÅ: T·∫≠p trung v√†o String, Slicing, List methods kh√°c
            [0, "ƒê·ªÉ in hoa to√†n b·ªô chu·ªói d√πng?", null, ["upper()", "lower()", "title()", "cap()"], 0, "s.upper()"],
            [0, "K·∫øt qu·∫£ `10 % 3`?", null, ["3", "1", "0", "3.33"], 1, "Ph√©p chia l·∫•y d∆∞."],
            [0, "Ph∆∞∆°ng th·ª©c x√≥a ph·∫ßn t·ª≠ kh·ªèi list?", null, ["del", "remove()", "pop()", "T·∫•t c·∫£ ƒë√∫ng"], 3, "C·∫£ 3 ƒë·ªÅu x√≥a ƒë∆∞·ª£c."],
            [0, "Tuple c√≥ thay ƒë·ªïi ƒë∆∞·ª£c kh√¥ng?", null, ["C√≥", "Kh√¥ng", "T√πy l√∫c", "Khi ch·ª©a list"], 1, "Immutable."],
            [0, "L·ªánh `break` d√πng ƒë·ªÉ?", null, ["Tho√°t ch∆∞∆°ng tr√¨nh", "Tho√°t v√≤ng l·∫∑p", "B·ªè qua l·∫ßn l·∫∑p", "D·ª´ng h√†m"], 1, "Tho√°t kh·ªèi loop g·∫ßn nh·∫•t."],
            // ... (Th√™m c√°c c√¢u kh√°c cho ƒë·ªß 26 LT + 24 TH) - Gi·∫£ l·∫≠p full c·∫•u tr√∫c
            [0, "H√†m `sorted()` tr·∫£ v·ªÅ?", null, ["List m·ªõi ƒë√£ s·∫Øp x·∫øp", "S·∫Øp x·∫øp t·∫°i ch·ªó", "None", "Tuple"], 0, "Tr·∫£ v·ªÅ list m·ªõi, list c≈© kh√¥ng ƒë·ªïi."],
            [0, "Key c·ªßa Dictionary ph·∫£i l√†?", null, ["Mutable", "Immutable", "List", "Dict"], 1, "Ph·∫£i l√† ki·ªÉu kh√¥ng ƒë·ªïi (hashable)."],
            [0, "ƒê·ªÉ l·∫•y gi√° tr·ªã tuy·ªát ƒë·ªëi?", null, ["abs()", "fbs()", "absolute()", "val()"], 0, "abs()"],
            [0, " `range(1, 5, 2)` sinh ra?", null, ["1, 2, 3, 4", "1, 3, 5", "1, 3", "1, 2"], 2, "Start 1, step 2 -> 1, 3."],
            [0, "ƒê·ªÉ n·ªëi 2 chu·ªói?", null, ["+", "-", "*", "/"], 0, "To√°n t·ª≠ c·ªông."],
            [0, "Bi·∫øn c·ª•c b·ªô t·ªìn t·∫°i ·ªü ƒë√¢u?", null, ["Trong h√†m", "To√†n ch∆∞∆°ng tr√¨nh", "Trong class", "Ngo√†i module"], 0, "Ch·ªâ trong ph·∫°m vi h√†m."],
            [0, " `pass` d√πng ƒë·ªÉ?", null, ["Tho√°t", "Kh√¥ng l√†m g√¨ c·∫£", "Qua v√≤ng l·∫∑p", "Tr·∫£ v·ªÅ"], 1, "Placeholder."],
            [0, "File mode 'a' l√† g√¨?", null, ["Read", "Write", "Append", "All"], 2, "Ghi n·ªëi ti·∫øp."],
            [0, "G√≥i (Package) ch·ª©a file g√¨?", null, ["__init__.py", "main.py", "index.html", "setup.exe"], 0, "ƒê√°nh d·∫•u th∆∞ m·ª•c l√† package."],
            [0, " `type(3.14)`?", null, ["int", "float", "double", "decimal"], 1, "S·ªë th·ª±c float."],
            [0, "To√°n t·ª≠ `and` tr·∫£ v·ªÅ True khi?", null, ["1 v·∫ø ƒë√∫ng", "C·∫£ 2 ƒë√∫ng", "C·∫£ 2 sai", "V·∫ø ƒë·∫ßu sai"], 1, "T·∫•t c·∫£ ph·∫£i True."],
            [0, " `strip()` d√πng ƒë·ªÉ?", null, ["C·∫Øt chu·ªói", "X√≥a kho·∫£ng tr·∫Øng ƒë·∫ßu cu·ªëi", "Thay th·∫ø", "T√¨m ki·∫øm"], 1, "Lo·∫°i b·ªè whitespace."],
            [0, " `list.insert(i, x)` l√†m g√¨?", null, ["Th√™m x v√†o cu·ªëi", "Th√™m x v√†o v·ªã tr√≠ i", "X√≥a t·∫°i i", "S·ª≠a t·∫°i i"], 1, "Ch√®n."],
            [0, " `__init__` nh·∫≠n tham s·ªë ƒë·∫ßu ti√™n l√†?", null, ["self", "cls", "this", "obj"], 0, "Quy ∆∞·ªõc l√† self."],
            [0, "Import to√†n b·ªô module?", null, ["import *", "from mod import *", "get all", "include *"], 1, "C√∫ ph√°p from... import *"],

            [1, "Pandas: ƒê·ªçc Excel?", null, ["read_csv", "read_excel", "load_xls", "open_excel"], 1, "read_excel"],
            [1, "Numpy: Ma tr·∫≠n ƒë∆°n v·ªã?", null, ["eye()", "ones()", "zeros()", "unit()"], 0, "Identity matrix."],
            [1, "Matplotlib: V·∫Ω bi·ªÉu ƒë·ªì tr√≤n?", null, ["bar()", "hist()", "pie()", "plot()"], 2, "Pie chart."],
            [1, "Numpy: Chuy·ªÉn v·ªã ma tr·∫≠n?", null, [".T", ".Transpose", ".flip", ".rotate"], 0, "Thu·ªôc t√≠nh .T"],
            [1, "Pandas: Xem 5 d√≤ng ƒë·∫ßu?", null, ["head()", "top()", "first()", "start()"], 0, "head()"],
            [1, "Matplotlib: Ch√∫ th√≠ch (Legend)?", null, ["note()", "legend()", "caption()", "tag()"], 1, "legend()"],

            [2, "K·∫øt qu·∫£?", "print(bool(0), bool(1))", ["False True", "True False", "True True", "False False"], 0, "0 l√† False."],
            [2, "K·∫øt qu·∫£?", "x = 'Python'\nprint(x[::-1])", ["nohtyP", "Python", "P", "n"], 0, "ƒê·∫£o ng∆∞·ª£c chu·ªói."],
            [2, "K·∫øt qu·∫£?", "l = [1, 2]\nl.extend([3, 4])\nprint(len(l))", ["2", "3", "4", "L·ªói"], 2, "Extend n·ªëi ph·∫ßn t·ª≠ -> [1,2,3,4]."],
            [2, "K·∫øt qu·∫£?", "def f(x): return x + 1\nprint(f(f(1)))", ["2", "3", "1", "4"], 1, "f(1)=2 -> f(2)=3."],
            [2, "Numpy?", "import numpy as np\na = np.ones(3)\nprint(a.sum())", ["1.0", "3.0", "0.0", "Error"], 1, "1+1+1=3."],
            [2, "Set?", "s = {1, 2}\ns.add(2)\nprint(s)", ["{1, 2, 2}", "{1, 2}", "{1}", "Error"], 1, "Kh√¥ng th√™m tr√πng."],
            [2, "List comp?", "print([x for x in range(3)])", ["[0, 1, 2]", "[1, 2, 3]", "(0, 1, 2)", "0 1 2"], 0, "List 0->2."],
            [2, "Dict?", "d = {1: 'a', 2: 'b'}\nprint(d.get(3))", ["None", "Error", "b", "False"], 0, "Key 3 kh√¥ng c√≥ -> None."],
            [2, "String format?", "name='A'\nprint(f'Hi {name}')", ["Hi name", "Hi {A}", "Hi A", "Error"], 2, "f-string."],
            [2, "Loop?", "c=0\nwhile c<2: c+=1\nprint(c)", ["1", "2", "3", "0"], 1, "0->1, 1->2 (stop)."],

            [3, " `plt.scatter()` v·∫Ω g√¨?", null, ["ƒê∆∞·ªùng", "C·ªôt", "ƒêi·ªÉm ph√¢n t√°n", "Tr√≤n"], 2, "Scatter plot."],
            [3, " `plt.xlabel()` l√†m g√¨?", null, ["T√™n tr·ª•c X", "T√™n tr·ª•c Y", "Ti√™u ƒë·ªÅ", "L∆∞·ªõi"], 0, "Nh√£n tr·ª•c ho√†nh."],

            [4, "ƒêi·ªÅn n·ªëi chu·ªói:", "' '.____(['A', 'B'])", ["join", "concat", "connect", "add"], 0, "join list."],
            [4, "ƒêi·ªÅn random s·ªë nguy√™n:", "random.___(1, 10)", ["int", "randint", "rand", "choice"], 1, "randint."],
            [4, "ƒêi·ªÅn check file t·ªìn t·∫°i:", "os.path.___(path)", ["exists", "has", "is", "find"], 0, "exists."],
            [4, "ƒêi·ªÅn ƒë·ªçc h·∫øt d√≤ng:", "f.___()", ["readlines", "read", "line", "get"], 0, "Tr·∫£ v·ªÅ list d√≤ng."],
            [4, "ƒêi·ªÅn t·∫°o class:", "___ MyClass:", ["def", "class", "struct", "obj"], 1, "class"],
            [4, "ƒêi·ªÅn l·∫•y ƒë·ªô d√†i:", "___(lst)", ["len", "length", "size", "count"], 0, "H√†m len()."],

            [5, "L·ªói c√∫ ph√°p?", "while True print(1)", ["Thi·∫øu :", "Sai while", "Sai print", "Kh√¥ng l·ªói"], 0, "Thi·∫øu hai ch·∫•m."],
            [5, "L·ªói dictionary?", "d = {[1]: 2}", ["KeyError", "TypeError", "SyntaxError", "Value"], 1, "List kh√¥ng l√†m key ƒë∆∞·ª£c (unhashable)."],
            [5, "L·ªói g·ªçi h√†m?", "def f(a): pass\nf()", ["NameError", "TypeError", "ValueError", "Syntax"], 1, "Thi·∫øu tham s·ªë a."],
            [5, "L·ªói import?", "import nomodule", ["ImportError", "NameError", "Syntax", "Type"], 0, "Module kh√¥ng t·ªìn t·∫°i."],
            [5, "L·ªói t√™n bi·∫øn?", "1variable = 10", ["SyntaxError", "NameError", "Type", "Value"], 0, "B·∫Øt ƒë·∫ßu b·∫±ng s·ªë."],
            [5, "L·ªói file?", "open('koco.txt', 'r')", ["FileNotFoundError", "IOError", "Name", "Syntax"], 0, "File kh√¥ng c√≥."]
        ];

        // T·∫°o th√™m De 3, 4, 5 t∆∞∆°ng t·ª± nh∆∞ng tr·ªôn v√† ƒë·ªïi c√¢u h·ªèi. 
        // ƒê·ªÉ ti·∫øt ki·ªám kh√¥ng gian, t√¥i s·∫Ω t·∫°o b·∫£n sao bi·∫øn thi√™n t·ª´ de1 v√† de2 cho 3,4,5.
        // Trong th·ª±c t·∫ø b·∫°n n√™n nh·∫≠p ƒë·ªß 5 b·ªô kh√°c nhau ho√†n to√†n.
        
        // H√†m tr·ªôn ng·∫´u nhi√™n m·ªôt m·∫£ng (Fisher-Yates)
        function shuffle(array) {
            let currentIndex = array.length, randomIndex;
            while (currentIndex != 0) {
                randomIndex = Math.floor(Math.random() * currentIndex);
                currentIndex--;
                [array[currentIndex], array[randomIndex]] = [array[randomIndex], array[currentIndex]];
            }
            return array;
        }

        // T·∫°o d·ªØ li·ªáu cho 5 ƒë·ªÅ t·ª´ ngu·ªìn c·ª©ng
        const quizData = {
            "de1": de1,
            "de2": de2,
            "de3": shuffle([...de1]).map(q => [...q]), // Clone v√† shuffle ƒë·ªÉ t·∫°o ƒë·ªÅ 3
            "de4": shuffle([...de2]).map(q => [...q]), // Clone v√† shuffle ƒë·ªÉ t·∫°o ƒë·ªÅ 4
            "de5": shuffle([...de1.slice(0, 25), ...de2.slice(25, 50)]) // Lai gh√©p t·∫°o ƒë·ªÅ 5
        };

        // --- APP LOGIC ---
        let currentQuiz = null;
        let userAnswers = {};
        let timerInterval;
        let timeLeft = 3600;
        let introHTML = "";

        // INIT
        window.addEventListener('DOMContentLoaded', () => {
            introHTML = document.getElementById('mainContent').innerHTML;
            renderNav();
        });

        function renderNav() {
            const navTabs = document.getElementById('navTabs');
            navTabs.innerHTML = '';
            Object.keys(quizData).forEach((key, index) => {
                const btn = document.createElement('button');
                btn.className = `nav-btn`;
                btn.innerText = `ƒê·ªÅ S·ªë ${index + 1}`;
                btn.onclick = () => loadQuiz(key, btn);
                navTabs.appendChild(btn);
            });
        }

        function loadQuiz(quizKey, btnElement) {
            // UI Update
            document.querySelectorAll('.nav-btn').forEach(b => b.classList.remove('active'));
            if(btnElement) btnElement.classList.add('active');
            
            document.getElementById('actionPanel').style.display = 'flex';
            const main = document.getElementById('mainContent');
            main.innerHTML = '';
            
            currentQuiz = quizData[quizKey];
            userAnswers = {};
            window.scrollTo(0, 0);

            // Render Questions grouped by type logic (Simple render for now)
            let currentType = -1;
            
            currentQuiz.forEach((q, index) => {
                // Group Header
                if (q[0] !== currentType) {
                    currentType = q[0];
                    const header = document.createElement('div');
                    header.className = 'section-header';
                    header.innerText = questionTypes[currentType] || "PH·∫¶N KH√ÅC";
                    main.appendChild(header);
                }

                const card = document.createElement('div');
                card.className = 'question-card';
                card.id = `q-${index}`;

                const codeHtml = q[2] ? `<div class="q-code-block">${q[2]}</div>` : '';

                let optionsHtml = '<div class="options-grid">';
                q[3].forEach((opt, optIndex) => {
                    optionsHtml += `
                        <label class="option-label" onclick="selectAnswer(${index}, ${optIndex})">
                            <input type="radio" name="q${index}" class="option-input" value="${optIndex}">
                            <span>${String.fromCharCode(65 + optIndex)}. ${opt}</span>
                        </label>
                    `;
                });
                optionsHtml += '</div>';

                const explainHtml = `<div class="explanation" id="explain-${index}">üëâ <strong>Gi·∫£i th√≠ch:</strong> ${q[5]}</div>`;

                card.innerHTML = `
                    <div class="q-title">
                        <span class="q-number">C√¢u ${index + 1}</span>
                        <div class="q-text">${q[1]}</div>
                    </div>
                    ${codeHtml}
                    ${optionsHtml}
                    ${explainHtml}
                `;
                main.appendChild(card);
            });

            startTimer();
        }

        function selectAnswer(qIndex, optIndex) {
            userAnswers[qIndex] = optIndex;
            const inputs = document.getElementsByName(`q${qIndex}`);
            inputs.forEach((inp, idx) => {
                const label = inp.parentElement;
                if (idx === optIndex) {
                    inp.checked = true;
                    label.style.borderColor = 'var(--secondary-color)';
                    label.style.background = '#f7fbff';
                } else {
                    label.style.borderColor = '#e0e0e0';
                    label.style.background = 'white';
                }
            });
        }

        function startTimer() {
            clearInterval(timerInterval);
            timeLeft = 3600;
            updateTimerDisplay();
            timerInterval = setInterval(() => {
                timeLeft--;
                updateTimerDisplay();
                if (timeLeft <= 0) {
                    clearInterval(timerInterval);
                    submitQuiz(true);
                }
            }, 1000);
        }

        function updateTimerDisplay() {
            const m = Math.floor(timeLeft / 60).toString().padStart(2, '0');
            const s = (timeLeft % 60).toString().padStart(2, '0');
            const display = document.getElementById('timerDisplay');
            display.innerText = `${m}:${s}`;
            display.style.color = timeLeft < 300 ? 'red' : 'var(--accent-color)';
        }

        function submitQuiz(auto = false) {
            if (!auto && !confirm('B·∫°n c√≥ ch·∫Øc ch·∫Øn mu·ªën n·ªôp b√†i?')) return;
            
            clearInterval(timerInterval);
            let score = 0;
            
            currentQuiz.forEach((q, index) => {
                const userAns = userAnswers[index];
                const correctAns = q[4];
                const card = document.getElementById(`q-${index}`);
                const labels = card.querySelectorAll('.option-label');
                const explain = document.getElementById(`explain-${index}`);

                explain.style.display = 'block';

                if (userAns !== undefined) {
                    if (userAns === correctAns) {
                        score++;
                        labels[userAns].classList.add('correct-answer');
                    } else {
                        labels[userAns].classList.add('wrong-answer');
                        labels[correctAns].classList.add('correct-answer');
                    }
                } else {
                    labels[correctAns].classList.add('correct-answer');
                }
                
                card.querySelectorAll('input').forEach(i => i.disabled = true);
                card.querySelectorAll('.option-label').forEach(l => {
                    l.style.cursor = 'default';
                    l.onclick = null;
                });
            });

            document.getElementById('scoreText').innerText = `${score}/50`;
            document.getElementById('scoreMessage').innerText = score >= 40 ? "Xu·∫•t s·∫Øc! üéâ" : (score >= 25 ? "ƒê·∫°t y√™u c·∫ßu üëç" : "C·∫ßn √¥n t·∫≠p th√™m üìö");
            document.getElementById('overlay').style.display = 'block';
            document.getElementById('scoreBoard').style.display = 'block';
            document.querySelector('.btn-submit').style.display = 'none';
        }

        function closeScoreAndReview() {
            document.getElementById('overlay').style.display = 'none';
            document.getElementById('scoreBoard').style.display = 'none';
            window.scrollTo(0, 0);
        }

        function backToMenu() {
            // Reset UI to Intro
            document.getElementById('overlay').style.display = 'none';
            document.getElementById('scoreBoard').style.display = 'none';
            document.getElementById('actionPanel').style.display = 'none';
            
            const main = document.getElementById('mainContent');
            main.innerHTML = introHTML;
            
            document.querySelectorAll('.nav-btn').forEach(b => b.classList.remove('active'));
            document.querySelector('.btn-submit').style.display = 'block';
            document.getElementById('timerDisplay').innerText = "60:00";
            
            window.scrollTo(0, 0);
        }

        function resetQuiz() {
            if(confirm("L√†m l·∫°i s·∫Ω x√≥a h·∫øt k·∫øt qu·∫£ hi·ªán t·∫°i?")) {
                const activeBtn = document.querySelector('.nav-btn.active');
                if(!activeBtn) return;
                
                // T√¨m l·∫°i key c·ªßa quiz ƒëang active
                let currentKey = '';
                document.querySelectorAll('.nav-btn').forEach((btn, idx) => {
                    if(btn === activeBtn) currentKey = `de${idx+1}`;
                });
                
                loadQuiz(currentKey, activeBtn);
                document.querySelector('.btn-submit').style.display = 'block';
            }
        }
    </script>
</body>
</html>
